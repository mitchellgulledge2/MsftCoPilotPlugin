openapi: 3.0.0
info:
  description: Netskope API documentation
  version: 1.0.0
  title: Netskope API
paths:
  /api/v2/events/data/alert:
    get:
      operationId: lookupNetskopeAlerts
      #displayName: Lookup Netskope Alerts
      summary: Lookup and summarize information about a set of Netskope Alerts
      description: >-
        Get a list of alerts generated by Netskope. You can filter by
        timeperiod, alert type, acknowledged, or advanced query parameters.
        #ExamplePrompt show me Netskope DLP Alerts between 1727983942 and 1727985942
        #ExamplePrompt show me Netskope Compromised Credential Alerts between 1727983942 and 1727985942 for user ron@gmail.com
        #ExamplePrompt show me Netskope uba Alerts between 1727983942 and 1727985942
        #ExamplePrompt show me Netskope Malware Alerts for user ron@gmail.com for last 3 months. 
      parameters:
        - description: Alert type you would like to filter on
          in: query
          name: type
          required: false
          schema:
            enum:
              - anomaly
              - uba
              - Compromised Credential
              - DLP
              - Legal Hold
              - Malware
              - malsite
              - policy
              - quarantine
              - Remediation
              - Security Assessment
              - watchlist
            type: string
        - description: Filter alerts by acknowledged status
          in: query
          name: acked
          required: false
          schema:
            enum:
              - 'true'
              - 'false'
            type: string
        - description: Advanced filter for retrieving alerts
          in: query
          name: query
          required: false
          schema:
            type: string
            example: query=(user%20eq%20'ron@gmail.com')
        - description: Max number of records to retrieve
          in: query
          name: limit
          required: false
          schema:
            default: 5000
            maximum: 5000
            minimum: 0
            type: integer
        - description: Used to shift the window of alerts if limit is reached
          in: query
          name: offset
          required: false
          schema:
            default: 0
            minimum: 0
            type: integer
        - description: Unix timestamp of start time period of alerts
          in: query
          name: starttime
          required: false
          schema:
            default: 0
            minimum: 0
            type: integer
        - description: Unix timestamp of end time period of alerts
          in: query
          name: endtime
          required: false
          schema:
            minimum: 0
            type: integer
        - description: >-
            Restrict alerts which have been inserted into the database after the
            specified time. Needed only if timeperiod or starttime/endtime is
            not passed. Only use one of these parameters at a time, not a
            combination: timeperiod, or starttime/endtime, or
            insertionstarttime/insertionendtime.
          in: query
          name: insertionstarttime
          required: false
          schema:
            default: 0
            minimum: 0
            type: integer
        - description: >-
            Restrict alerts which have been inserted into the database before
            the specified time. Needed only if timeperiod or starttime/endtime
            is not passed.
          in: query
          name: insertionendtime
          required: false
          schema:
            minimum: 0
            type: integer
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  ok:
                    default: 1
                    enum:
                      - 0
                      - 1
                    type: integer
                  result:
                    items:
                      type: object
                    type: array
                type: object
          description: successful operation
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/400'
          description: Invalid request
      tags:
        - events
    x-netskope-params:
      apiGroup: alert
      customerFacing: true
      serviceConfig: queryservice
      version: 2
  /api/v2/events/data/application:
    get:
      operationId: lookupNetskopeApplicationEvents
      #displayName: Lookup Netskope Application Events
      summary: Lookup information about Netskope Application Events in your tenant for all or specific users
      description: >-
        Get a list of application events generated by Netskope. You can filter
        by timeperiod or advanced query parameters.
        #ExamplePrompt show me Netskope Application Events between 1727983942 and 1727985942
        #ExamplePrompt show me Netskope Application Events between 1727983942 and 1727985942 for user ron@gmail.com
        #ExamplePrompt show me Netskope Application Events for user ron@gmail.com for last 3 months.
      parameters:
        - description: Advanced filter for retrieving application events
          in: query
          name: query
          required: false
          schema:
            type: string
            example: query=(user%20eq%20'ron@gmail.com')
        - description: Max number of records to retrieve
          in: query
          name: limit
          required: false
          schema:
            default: 5000
            maximum: 5000
            minimum: 0
            type: integer
        - description: Used to shift the window of alerts if limit is reached
          in: query
          name: offset
          required: false
          schema:
            default: 0
            minimum: 0
            type: integer
        - description: Unix timestamp of start time period of alerts
          in: query
          name: starttime
          required: false
          schema:
            default: 0
            minimum: 0
            type: integer
        - description: Unix timestamp of end time period of alerts
          in: query
          name: endtime
          required: false
          schema:
            minimum: 0
            type: integer
        - description: >-
            Restrict alerts which have been inserted into the database after the
            specified time. Needed only if timeperiod or starttime/endtime is
            not passed. Only use one of these parameters at a time, not a
            combination: timeperiod, or starttime/endtime, or
            insertionstarttime/insertionendtime.
          in: query
          name: insertionstarttime
          required: false
          schema:
            default: 0
            minimum: 0
            type: integer
        - description: >-
            Restrict alerts which have been inserted into the database before
            the specified time. Needed only if timeperiod or starttime/endtime
            is not passed.
          in: query
          name: insertionendtime
          required: false
          schema:
            minimum: 0
            type: integer
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  ok:
                    default: 1
                    enum:
                      - 0
                      - 1
                    type: integer
                  result:
                    items:
                      type: object
                    type: array
                type: object
          description: successful operation
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/400'
          description: Invalid request
      tags:
        - events
    x-netskope-params:
      apiGroup: application
      customerFacing: true
      serviceConfig: queryservice
      version: 2
  /api/v2/events/data/audit:
    get:
      operationId: lookupNetskopeAuditEvents 
      #displayName: Lookup Netskope Audit Events
      summary: Lookup Netskope Audit Events from your Netskope Tenant
      description: >-
        Get a list of audit events generated by Netskope. You can filter by
        timeperiod or advanced query parameters.
        #ExamplePrompt show me Netskope Audit Events between 1727983942 and 1727985942
        #ExamplePrompt show me Netskope Audit Events between 1727983942 and 1727985942 for user ron@gmail.com
        #ExamplePrompt show me Netskope Audit Events for user ron@gmail.com for last 3 months.
      parameters:
        - description: Advanced filter for retrieving audit events
          in: query
          name: query
          required: false
          schema:
            type: string
            example: query=(user%20eq%20'ron@gmail.com')
        - description: Max number of records to retrieve
          in: query
          name: limit
          required: false
          schema:
            default: 5000
            maximum: 5000
            minimum: 0
            type: integer
        - description: Used to shift the window of alerts if limit is reached
          in: query
          name: offset
          required: false
          schema:
            default: 0
            minimum: 0
            type: integer
        - description: Unix timestamp of start time period of alerts
          in: query
          name: starttime
          required: false
          schema:
            default: 0
            minimum: 0
            type: integer
        - description: Unix timestamp of end time period of alerts
          in: query
          name: endtime
          required: false
          schema:
            minimum: 0
            type: integer
        - description: >-
            Restrict alerts which have been inserted into the database after the
            specified time. Needed only if timeperiod or starttime/endtime is
            not passed. Only use one of these parameters at a time, not a
            combination: timeperiod, or starttime/endtime, or
            insertionstarttime/insertionendtime.
          in: query
          name: insertionstarttime
          required: false
          schema:
            default: 0
            minimum: 0
            type: integer
        - description: >-
            Restrict alerts which have been inserted into the database before
            the specified time. Needed only if timeperiod or starttime/endtime
            is not passed.
          in: query
          name: insertionendtime
          required: false
          schema:
            minimum: 0
            type: integer
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  ok:
                    default: 1
                    enum:
                      - 0
                      - 1
                    type: integer
                  result:
                    items:
                      type: object
                    type: array
                type: object
          description: successful operation
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/400'
          description: Invalid request
      tags:
        - events
    x-netskope-params:
      apiGroup: audit
      customerFacing: true
      serviceConfig: queryservice
      version: 2
  /api/v2/events/data/network:
    get:
      operationId: lookupNetskopeNetworkEvents
      #displayName: Lookup Netskope Network Events
      summary: Lookup Netskope Network Events for your tenant
      description: >-
        Get a list of network events generated by Netskope. You can filter by
        timeperiod or advanced query parameters.
        #ExamplePrompt show me Netskope Network Events between 1727983942 and 1727985942
        #ExamplePrompt show me Netskope Network Events between 1727983942 and 1727985942 for user ron@gmail.com
        #ExamplePrompt show me Netskope Network Events for user ron@gmail.com for last 3 days.   
      parameters:
        - description: Advanced filter for retrieving network events
          in: query
          name: query
          required: false
          schema:
            type: string
            example: query=(user%20eq%20'ron@gmail.com')
        - description: Max number of records to retrieve
          in: query
          name: limit
          required: false
          schema:
            default: 5000
            maximum: 5000
            minimum: 0
            type: integer
        - description: Used to shift the window of alerts if limit is reached
          in: query
          name: offset
          required: false
          schema:
            default: 0
            minimum: 0
            type: integer
        - description: Unix timestamp of start time period of alerts
          in: query
          name: starttime
          required: false
          schema:
            default: 0
            minimum: 0
            type: integer
        - description: Unix timestamp of end time period of alerts
          in: query
          name: endtime
          required: false
          schema:
            minimum: 0
            type: integer
        - description: >-
            Restrict alerts which have been inserted into the database after the
            specified time. Needed only if timeperiod or starttime/endtime is
            not passed. Only use one of these parameters at a time, not a
            combination: timeperiod, or starttime/endtime, or
            insertionstarttime/insertionendtime.
          in: query
          name: insertionstarttime
          required: false
          schema:
            default: 0
            minimum: 0
            type: integer
        - description: >-
            Restrict alerts which have been inserted into the database before
            the specified time. Needed only if timeperiod or starttime/endtime
            is not passed.
          in: query
          name: insertionendtime
          required: false
          schema:
            minimum: 0
            type: integer
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  ok:
                    default: 1
                    enum:
                      - 0
                      - 1
                    type: integer
                  result:
                    items:
                      type: object
                    type: array
                type: object
          description: successful operation
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/400'
          description: Invalid request
      tags:
        - events
    x-netskope-params:
      apiGroup: network
      customerFacing: true
      serviceConfig: queryservice
      version: 2
  /api/v2/events/data/page:
    get:
      operationId: lookupNetskopePageEvents
      #displayName: Lookup Netskope Page Events
      summary: Lookup Netskope page events inside your tenant
      description: >-
        Get a list of page events generated by Netskope. You can filter by
        timeperiod or advanced query parameters.
        #ExamplePrompt show me Netskope Page Events between 1727983942 and 1727985942
        #ExamplePrompt show me Netskope Page Events between 1727983942 and 1727985942 for user ron@gmail.com
        #ExamplePrompt show me Netskope Page Events for user ron@gmail.com for last 3 days.      
      parameters:
        - description: Advanced filter for retrieving page events
          in: query
          name: query
          required: false
          schema:
            type: string
            example: query=(user%20eq%20'ron@gmail.com')
        - description: Max number of records to retrieve
          in: query
          name: limit
          required: false
          schema:
            default: 5000
            maximum: 5000
            minimum: 0
            type: integer
        - description: Used to shift the window of alerts if limit is reached
          in: query
          name: offset
          required: false
          schema:
            default: 0
            minimum: 0
            type: integer
        - description: Unix timestamp of start time period of alerts
          in: query
          name: starttime
          required: false
          schema:
            default: 0
            minimum: 0
            type: integer
        - description: Unix timestamp of end time period of alerts
          in: query
          name: endtime
          required: false
          schema:
            minimum: 0
            type: integer
        - description: >-
            Restrict alerts which have been inserted into the database after the
            specified time. Needed only if timeperiod or starttime/endtime is
            not passed. Only use one of these parameters at a time, not a
            combination: timeperiod, or starttime/endtime, or
            insertionstarttime/insertionendtime.
          in: query
          name: insertionstarttime
          required: false
          schema:
            default: 0
            minimum: 0
            type: integer
        - description: >-
            Restrict alerts which have been inserted into the database before
            the specified time. Needed only if timeperiod or starttime/endtime
            is not passed.
          in: query
          name: insertionendtime
          required: false
          schema:
            minimum: 0
            type: integer
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  ok:
                    default: 1
                    enum:
                      - 0
                      - 1
                    type: integer
                  result:
                    items:
                      type: object
                    type: array
                type: object
          description: successful operation
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/400'
          description: Invalid request
      tags:
        - events
    x-netskope-params:
      apiGroup: page
      customerFacing: true
      serviceConfig: queryservice
      version: 2
components:
  schemas:
    '200':
      description: successful operation
      type: object
      properties:
        status:
          type: string
          example: success
    '400':
      description: Bad request response
      type: object
      properties:
        message:
          type: string
          example: Bad request
    '401':
      description: Bad request response
      type: object
      properties:
        message:
          type: string
          example: Bad request
    '403':
      description: Bad request response
      type: object
      properties:
        message:
          type: string
          example: Bad request
    '404':
      description: Bad request response
      type: object
      properties:
        message:
          type: string
          example: Bad request
    '405':
      description: Method not allowed response
      type: object
      properties:
        message:
          type: string
          example: Method not allowed
    '408':
      description: Timeout response
      type: object
      properties:
        message:
          type: string
          example: Request timed out
    '413':
      description: Payload too large
      type: object
      properties:
        message:
          type: string
          example: Payload too long
    '414':
      description: URI too long
      type: object
      properties:
        message:
          type: string
          example: URI too long
    '429':
      description: Too many requests response
      type: object
      properties:
        message:
          type: string
          example: Too many requests

  securitySchemes:
    api_key:
      type: apiKey
      in: header
      name: Netskope-Api-Token
